<!DOCTYPE html>
<html>
<head>
    <title>Member Voting</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f2f2f2;
            margin: 0;
            padding: 0;
            text-align: center;
        }
        .hidden { display: none; }

        /* Countdown Page */
        #countdownPage { padding: 50px; }
        #countdown { font-size: 32px; margin-top: 20px; font-weight: bold; }

        /* Verification Page */
        #verifyPage { padding: 40px; }
        .verify-box {
            background: white;
            max-width: 500px;
            margin: auto;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        select, input {
            width: 90%;
            padding: 12px;
            margin-top: 15px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 16px;
        }
        .verify-btn {
            margin-top: 20px;
            padding: 12px 30px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
        }

        /* Voting Page */
        #votingPage { padding: 20px; }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            max-width: 900px;
            margin: auto;
        }
        .card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
            border: 2px solid transparent;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            user-select: none;
        }
        .card:hover {
            transform: scale(1.05);
            border-color: #007bff;
        }
        .card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
        }
        .card h3 {
            margin: 10px 0 0 0;
        }
        .card input {
            display: none;
        }
        .card input:checked + img {
            border: 3px solid #007bff;
        }
        .submit-btn {
            margin-top: 30px;
            padding: 12px 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
        }

        /* Mobile adjustments */
        @media(max-width: 480px){
            .card img { height: 120px; }
            .card h3 { font-size: 16px; }
        }
    </style>
</head>
<body>

<!-- â³ COUNTDOWN PAGE -->
<div id="countdownPage">
    <h1>Voting will start soon</h1>
    <p id="countdown"></p>
</div>

<!-- ðŸ” VERIFICATION PAGE -->
<div id="verifyPage" class="hidden">
    <h2>User Verification</h2>
    <div class="verify-box">
        <label>Select Your Name</label>
        <select id="voterName">
            <option value="">-- Select --</option>
        </select>

        <label>Enter 4 Digit Access Code</label>
        <input type="password" id="accessCode" maxlength="4" placeholder="****">

        <button class="verify-btn" onclick="validateAccess()">Verify & Continue</button>
        <p id="verifyError" style="color:red; margin-top:10px;"></p>
    </div>
</div>

<!-- ðŸ—³ï¸ VOTING PAGE -->
<div id="votingPage" class="hidden">
    <h2>Vote for Your Candidate</h2>
    <form id="voteForm">
        <input type="hidden" name="VerifiedName" id="verifiedName">

        <div class="grid">
            <label class="card">
                <input type="radio" name="ElectedPerson" value="Bikram Mondal" required>
                <img src="https://via.placeholder.com/200x150">
                <h3>Bikram Mondal</h3>
            </label>
            <label class="card">
                <input type="radio" name="ElectedPerson" value="Debokinandan Maity">
                <img src="https://via.placeholder.com/200x150">
                <h3>Debokinandan Maity</h3>
            </label>
            <label class="card">
                <input type="radio" name="ElectedPerson" value="Hiranmoy Mete">
                <img src="https://via.placeholder.com/200x150">
                <h3>Hiranmoy Mete</h3>
            </label>
            <label class="card">
                <input type="radio" name="ElectedPerson" value="Partha Chakraborty">
                <img src="https://via.placeholder.com/200x150">
                <h3>Partha Chakraborty</h3>
            </label>
        </div>

        <button class="submit-btn" type="submit">Submit Vote</button>
    </form>
</div>

<!-- â›” END PAGE -->
<div id="endPage" class="hidden">
    <h1>Thanks for visiting</h1>
    <p>Voting has ended.</p>
</div>

<script>
// CONFIG
const startTime = new Date("2025-12-12T10:00:00").getTime();
const endTime   = new Date("2025-12-12T23:32:00").getTime();

// Full list of names + codes
const validCodes = {
"Avijit Manna": "4821","Atanu Bhowmick": "7394","Hiranmoy Meta": "1583","Pranab Jana": "6249",
"Ayan Bhowmick": "9172","Santanu Mondal": "3056","Priyanshu Man": "8642","Anupam Adak": "5128",
"Surajit Pakhira": "7039","Priyatosh Jana": "9461","Abinash Adak": "3927","Babu Dolui": "5810",
"Sk Haklin Mustak": "2074","Santanu Bhowmick": "6783","Sidyut Dolui": "8539","Samrat Bairy": "4917",
"Buddhadeb Ghosh": "2365","Saikat Manna": "7641","Abhijit Shaw": "3308","Chayan Bag": "9540",
"Tarun Malik": "1492","Nityananda Bor": "8806","Ujjal Pandit": "6135","Sourav Sing": "7259",
"Sagar Bhuinya": "8903","Dipayan Chattoraj": "4471","Soumen Bhuinya": "9556","Jahira Khatun": "1684",
"Sangita Jana (Pramanick)": "7398","Jhuma Bhuinya": "6642","Nivedita Pal": "8297","Rituparna Malik (Porey)": "2914",
"Madhumita Malik": "1389","Samima Sultana": "5073","Priyanka Roy": "9164","Arpita Malik": "7205",
"Prodip Singh": "8512","Aniruddha Adak": "2349","Rahul Manna": "9941","Prakash Adak": "4753",
"Rahul Bhowmick": "6901","Sourav Bhowmick": "5827","Arup Bar": "2103","Saikat Bag": "7560",
"Bikram Mondal": "8035","Rajesh Bag": "6772","Sangita Samanta (Roychowdhury)": "9407","Falguni Malik": "1284",
"Payel Bhowmick (Jana)": "5520","Antara Adak": "3662","Riya Maji (Samanta)": "4719","Amit Bhowmick": "6344",
"Chandan Adak": "8109","Sudip Pandit": "9208","Rohit Samanta": "1035","Tanmoy Bhuinya": "5017",
"Keya Adak": "7486","Sudipa Samanta": "4190","Shovon Adak": "8914","Hironmay Hambir": "2601",
"Sk Mustakin": "5743","Jayasri Guchhait (Maji)": "9472","Amit Adak": "1106","Lakshmi Malik": "8217",
"Sabita Malik": "5784","Baishakhi Bera": "3894","Shreya Maji": "6152","Moumita Bhowmick (Jana)": "9795",
"Srabani Bera": "4286","Asish Bera": "6039","Ankan Bairy": "8740","Debasis Bag": "3921",
"Suman Bhowmick": "7128","Riya Mondal (Gayen)": "6213","Sanu Adak": "8649","Jhuma Malik": "5703",
"Susmita Mondal": "8497","Shadiya Shagmin": "3327","Susmita Adak": "6870","Piu Pandit (Denra)": "9062",
"Riju Bera": "8146","Ganesh Hazra": "2307","Puja Bhuinya": "5641","Sonjib Bor": "9275",
"Sourav Hazra": "3611","Suraj Prodhan": "7430","Pradip Gupta": "9005","Akash Prodhan": "2674",
"Sk Nasim": "6028","Debokinandan Maity": "7159","Suvankar Patra": "9436","Palash Malik": "4678",
"Banashre Bor": "5531","Sunil Bar": "7391","Sourav Sana": "8048","Sudipta Dolui": "2237",
"Partha Chakraborty": "9185","Suman Manna": "4260","Tanmoy Adak": "5896","Samir Bar": "3310",
"Papan Santra": "9746","Amirul Munsi": "3465","Amrita Bera": "6159","Sonali Bhuinya": "8812",
"Ananya Bera": "6023","Piu Man": "4902","Priya Santra": "4478","Srijay Bhowmick": "8371",
"Subrata Chakraborty": "2690","Munmun Bhowmik": "7103","Akshay Chattoraj": "9854","Soumen Dolui": "8253",
"Sourav Patra": "6357","Ankita Pore": "1448","Rohit Kumar Meta": "7985","Pinki Bag": "7634",
"Rakesh Mondal": "2831","Souvik Maji": "4928","Tanay Pal": "6279","Biswajit Malik": "3157",
"Sk. Nasim Hossain": "7742","Srabani Mondal (Maji)": "9098","Pralay Bhowmick": "3472",
"Debasis Bhuinya": "5781","Rajesh Denra": "1436","Souvik Bera": "6658","Sujay Dolui": "8054",
"Sadhana Maji": "3491","Madhumita Chakraborty": "6037","Shreya Chakraborty": "4860",
"Pooja Maity (Bhowmick)": "5092","Sumadri Bera": "9203","Manabi Bera": "5176","Payel Halder": "4079",
"Koyel Bera": "7618","Nibedita Manna": "6381","Tufan Bhowmick": "8435","Moumita Samanta (Samui)": "5243",
"TRIDIB CHATTARAJ": "9574","UTTAM DENRA": "8061","Susmita Singh (Adak)": "3104","SOUMI SAMUI": "6442",
"MOUMITA MAJI": "1157","Subhadip Meta": "7296","Sima Chakraborty": "2805","Sk Azizul": "5219",
"Sonali Bag": "3266","Mandira Mondal": "9710","Amit Roy": "4329","Hriday Krishna Sau": "5168"
};

// Populate dropdown
const voterSelect = document.getElementById("voterName");
Object.keys(validCodes).forEach(name => {
    const option = document.createElement("option");
    option.value = name;
    option.textContent = name;
    voterSelect.appendChild(option);
});

// Elements
const countdownPage = document.getElementById("countdownPage");
const verifyPage = document.getElementById("verifyPage");
const votingPage = document.getElementById("votingPage");
const endPage = document.getElementById("endPage");
const countdownEle = document.getElementById("countdown");

let verified = false;

// Timer
setInterval(() => {
    const now = Date.now();
    if (now < startTime) {
        countdownPage.classList.remove("hidden");
        verifyPage.classList.add("hidden");
        votingPage.classList.add("hidden");
        endPage.classList.add("hidden");

        const diff = startTime - now;
        const min = Math.floor(diff / 60000);
        const sec = Math.floor((diff % 60000) / 1000);
        countdownEle.innerHTML = `Voting Starts In: ${min}m : ${sec}s`;
    } else if (now >= startTime && now <= endTime) {
        countdownPage.classList.add("hidden");
        endPage.classList.add("hidden");

        if (!verified) {
            verifyPage.classList.remove("hidden");
            votingPage.classList.add("hidden");
        } else {
            verifyPage.classList.add("hidden");
            votingPage.classList.remove("hidden");
        }
    } else {
        countdownPage.classList.add("hidden");
        verifyPage.classList.add("hidden");
        votingPage.classList.add("hidden");
        endPage.classList.remove("hidden");
    }
}, 1000);

// Verification function
function validateAccess() {
    const name = document.getElementById("voterName").value;
    const code = document.getElementById("accessCode").value;
    const error = document.getElementById("verifyError");

    if (!name) { error.textContent = "Please select a name."; return; }
    if (code.length !== 4) { error.textContent = "Enter a 4-digit code."; return; }
    if (validCodes[name] !== code) { error.textContent = "Invalid access code!"; return; }

    document.getElementById("verifiedName").value = name;
    verified = true;
    verifyPage.classList.add("hidden");
    votingPage.classList.remove("hidden");
}

// Vote submission using fetch
document.getElementById("voteForm").addEventListener("submit", async function(e) {
    e.preventDefault(); // prevent default form submit

    const choice = document.querySelector("input[name='ElectedPerson']:checked");
    if (!choice) {
        alert("Please select a candidate.");
        return;
    }

    if (!confirm("Are you sure you want to vote for: " + choice.value + " ?")) return;

    const formData = new FormData(this);
    formData.set("VerifiedName", document.getElementById("verifiedName").value);

    try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbysp2_DQlc5RhPR9KMSwvG91GveNxGg5V3dRKfIxIR5gLK8iZ_VbxlcXHJ2ZC_vSi2GCQ/exec", {
            method: "POST",
            body: formData
        });

        if (!response.ok) throw new Error("Network response was not ok.");

        alert("Thank you! Your vote has been submitted.");

        // Reset form and return to access page
        document.getElementById("voteForm").reset();
        verified = false; // require verification again
        votingPage.classList.add("hidden");
        verifyPage.classList.remove("hidden");
        document.getElementById("accessCode").value = "";
        document.getElementById("verifyError").textContent = "";
    } catch (error) {
        console.error("Error submitting vote:", error);
        alert("Error submitting vote. Please try again.");
    }
});
</script>
</body>
</html>
